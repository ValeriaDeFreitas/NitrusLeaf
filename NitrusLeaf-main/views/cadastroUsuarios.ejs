<%- include('partials/header.ejs') %>
<%- include('partials/navbar.ejs') %>

<% if (messages.danger) { %>
    <div class="alert alert-danger">
        <%= messages.danger %>
    </div>
<% } %>

<div class="container mt-5">
    <div class="card">
        <div class="card-header">
            <h2>Cadastrar-se</h2>
        </div>
        <div class="card-body">
            <form action="/createUsuarios" method="POST">
                <!-- Nome -->
                <div class="mb-3">
                    <label for="nome" class="form-label">Nome</label>
                    <input type="text" class="form-control" id="nome" name="nome" placeholder="Insira seu nome" required>
                </div>

                <!-- Sobrenome -->
                <div class="mb-3">
                    <label for="sobrenome" class="form-label">Sobrenome</label>
                    <input type="text" class="form-control" id="sobrenome" name="sobrenome" placeholder="Insira seu sobrenome" required>
                </div>
                <!-- Telefone -->
                <div class="mb-3">
                    <label for="telefone" class="form-label">Telefone</label>
                    <input type="text" class="form-control" id="telefone" name="telefone" placeholder="Insira seu telefone">
                </div>

                <!-- Celular -->
                <div class="mb-3">
                    <label for="celular" class="form-label">Celular</label>
                    <input type="text" class="form-control" id="celular" name="celular" placeholder="Insira seu celular">
                </div>


                <!-- E-mail -->
                <div class="mb-3">
                    <label for="email" class="form-label">E-mail</label>
                    <input type="email" class="form-control" id="email" name="email" placeholder="Insira seu e-mail" required>
                </div>

                <!-- Senha -->
                <div class="mb-3">
                    <label for="senha" class="form-label">Senha</label>
                    <input type="password" class="form-control" id="senha" name="senha" placeholder="Crie sua senha" required>
                </div>

                <!-- Checkbox para exibir campos adicionais -->
                <div class="mb-3 form-check">
                    <input type="checkbox" class="form-check-input" id="mostrarCampos" name="mostrarCampos">
                    <label class="form-check-label" for="mostrarCampos">Deseja fornecer mais detalhes?</label>
                </div>

                <!-- Campos adicionais -->
                <div id="camposAdicionais" class="d-none">
                    <!-- Seleção do Tipo de Pessoa (CPF ou CNPJ) -->
                    <div class="mb-3">
                        <label for="tipo_pessoa" class="form-label">Tipo de pessoa</label>
                        <select name="tipo_pessoa" id="tipo_pessoa" class="form-control" required>
                            <option value="" selected disabled>Selecione o tipo de pessoa</option>
                            <option value="fisica">Pessoa Física</option>
                            <option value="juridica">Pessoa Jurídica</option>
                        </select>
                    </div>

                    <!-- Campo CPF ou CNPJ -->
                    <div id="cpfContainer" class="mb-3">
                        <label for="cpf" class="form-label">CPF</label>
                        <input type="text" class="form-control" id="cpf" name="cpf" placeholder="Insira seu CPF">
                    </div>
                    <div id="cnpjContainer" class="mb-3 d-none">
                        <label for="cnpj" class="form-label">CNPJ</label>
                        <input type="text" class="form-control" id="cnpj" name="cnpj" placeholder="Insira seu CNPJ">
                    </div>

                    <!-- Endereço -->
                    <div class="mb-3">
                        <label for="logradouro" class="form-label">Logradouro</label>
                        <input type="text" class="form-control" id="logradouro" name="logradouro" placeholder="Insira seu logradouro">
                    </div>
                    <div class="mb-3">
                        <label for="numero" class="form-label">Número</label>
                        <input type="text" class="form-control" id="numero" name="numero" placeholder="Insira o número da residência">
                    </div>
                    <div class="mb-3">
                        <label for="bairro" class="form-label">Bairro</label>
                        <input type="text" class="form-control" id="bairro" name="bairro" placeholder="Insira seu bairro">
                    </div>
                    <div class="mb-3">
                        <label for="cidade" class="form-label">Cidade</label>
                        <input type="text" class="form-control" id="cidade" name="cidade" placeholder="Insira sua cidade">
                    </div>
                </div>

                <!-- Botão para cadastrar -->
                <button type="submit" class="btn btn-success btn-block">Cadastrar</button>
            </form>

            <hr>

            <h6>Já possui conta? <a href="/login">Faça o login</a></h6>
        </div>
    </div>
</div>

<%- include('partials/footer.ejs') %>

<script>
    // Mostra ou oculta os campos adicionais ao selecionar a checkbox
    document.getElementById('mostrarCampos').addEventListener('change', function () {
        const camposAdicionais = document.getElementById('camposAdicionais');
        camposAdicionais.classList.toggle('d-none', !this.checked);
    });

    // Alterna entre CPF e CNPJ dependendo do tipo de pessoa selecionado
    document.getElementById('tipo_pessoa').addEventListener('change', function () {
        const tipoPessoa = this.value;
        const cpfContainer = document.getElementById('cpfContainer');
        const cnpjContainer = document.getElementById('cnpjContainer');
        
        // Exibe o campo correto
        if (tipoPessoa === 'fisica') {
            cpfContainer.classList.remove('d-none');
            cnpjContainer.classList.add('d-none');
            document.getElementById('cpf').required = true;
            document.getElementById('cnpj').required = false;
        } else if (tipoPessoa === 'juridica') {
            cpfContainer.classList.add('d-none');
            cnpjContainer.classList.remove('d-none');
            document.getElementById('cpf').required = false;
            document.getElementById('cnpj').required = true;
        }
    });
</script>
